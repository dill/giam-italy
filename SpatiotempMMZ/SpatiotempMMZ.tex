\documentclass[10pt] {article}
%\documentclass[referee]{biom} 
%\usepackage{epsf}
%\usepackage{graphics}
%\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{makeidx}
\usepackage{latexsym}
\usepackage{bm}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{setspace}

\usepackage{amssymb}
%\usepackage{lscape,rotate}
%\usepackage{rotating}
%\usepackage{xtab}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{makeidx}
\usepackage{latexsym}
\usepackage{bm}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{setspace}
\usepackage{rotating}
%\usepackage{tabularx}
%\usepackage{booktabs}

 
\onehalfspacing
%\doublespacing
\setlength{\textheight}{22.5cm}
\setlength{\textwidth}{6.47in}
\setlength{\oddsidemargin}{-1mm}
\setlength{\topmargin}{0.1cm}
\setlength{\evensidemargin}{-5mm}
\makeindex

\newcommand{\captionfonts}{\footnotesize}
\makeatletter  
\long\def\@makecaption#1#2{
  \vskip\abovecaptionskip
  \sbox\@tempboxa{{\captionfonts #1: #2}}
  \ifdim \wd\@tempboxa >\hsize
    {\captionfonts #1: #2\par}
  \else
    \hbox to\hsize{\hfil\box\@tempboxa\hfil}
  \fi
  \vskip\belowcaptionskip}
\makeatother


\newcommand {\hide}[1] {\typeout{ #1 }}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\dif}[2]{\frac{{\rm d} #1}{{\rm d} #2}}
\newcommand{\ildif}[2]{{\rm d} #1/{{\rm d} #2 }}
\newcommand{\ilpdif}[2]{\partial #1/{\partial #2 }}
\newcommand{\pdif}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pddif}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3}}
\newcommand{\ilpddif}[3]{\partial^2 #1/{\partial #2 \partial #3}}
\newcommand{\comb}[2]{\left (\begin{array}{c}{#1}\\{#2}\end{array}\right )}
\newcommand{\perm}[2]{^{#1}{\rm P}_{#2}}
\newcommand{\gfrac}[2]{\mbox{$ { \textstyle{ \frac{#1}{#2} }\displaystyle}$}}
\newcommand{\defn}{\begin{quote}{\bf Definition. }}
\newcommand{\edefn}{\end{quote}}
\newcommand{\thm}{\begin{theorem}}
\newcommand{\ethm}{\end{theorem}}
\newcommand{\R}{{\sf R}}
\newcommand{\s}{{\sf S}}
\newcommand{\fnzero}{\setcounter{footnote}{0}}
\newcommand{\bmat}[1]{\left ( \begin{array}{#1}}
\newcommand{\emat}{\end{array}\right )}
\newcommand{\E}{\mathbb{E}}
\newcommand{\ts}{^{\sf T}} 
\newcommand{\its}{^{\sf -T}}
\newcommand{\fv}{\hat{\bm{\mu}}}
\newcommand{\X}{{\bf X}}
\newcommand{\Xt}{\X\ts}
\newcommand{\y}{{\bf y}}
\newcommand{\A}{{\bf A}}
\newcommand{\Qf}{{\bf Q}_{\rm f}}
\newcommand{\bp}{{\bm \beta}}
\newcommand{\rsd}{\hat {\bm \epsilon}}
\newcommand{\grad}{\nabla_\beta}
\newcommand{\tr}[1]{{\rm tr}\left ( {#1} \right )}
\theoremstyle{definition}
\newtheorem*{defin}{Definition}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newcommand{\rss}{{\cal S}}
\newcommand{\eps}[3]
{{\begin{center}
\rotatebox{#1}{\scalebox{#2}{\includegraphics{#3}}}
\end{center}}
}
\newcommand{\smsz}{\small}


\begin{document}


\title{Modeling Spatiotemporal Polarization of Resident Foreign Population}

\author{Giampiero Marra, David L. Miller, and Luca Zanin
%, \\ xxxxxxxxxxxxxxxxxxxxxxx \\ E-mail: luca.zanin@studio.unibo.it 
}
%\footnote{Address for correspondence: Luca Zanin, Prometeia, via G. Marconi 43, 40122 Bologna, Italy. E-mail: luca.zanin@studio.unibo.it, tel.: +39 051 64 80 451, fax: +39 05 12 20 753.}

\maketitle


%\begin{abstract}



%\vspace{0.4cm}
%\noindent \textbf{Keywords:} 

%\noindent \textbf{JEL Classification numbers:} C14, C25, D1.

%\end{abstract}

\section{Introduction \label{IN}}

Migrants play an important socio-economic role in all countries. They perform vital functions in boosting the economy by working in jobs that others cannot (or would not) do, however they also cause controversy due to their increasing use of public services. Increased political interest, as well as academic interest has lead to a large volume of both theoretical and applied work regarding international migration: its causes and implications for both natives and foreigners.

Several migration theories have been proposed in the literature, from both a macro- and micro-economic point of view, based on different schools of thought. Examples include: the neoclassical economic theory (e.g., Borjas 1989; Massey et al. 1993), the assumptions regarding the new economics of migration(WHAT? This doesn't make sense in English, can you clarify? --DLM) (e.g., Stark and Bloom 1985; Massey et al. 1993), dual labor markets (e.g., Piore 1979; Massey et al. 1993) and world systems theory (AGAIN, I'm not sure what this is, expand or elaborate? --DLM) (e.g., Wallerstein 1974; Portes and Walton 1981; Morawska 1990; Hooghe et al. 2008). As pointed out, e.g., by Massey et al. (1993), migration perpetuates migration via migrant networks which connect migrants and non-migrants in both origin and destination regions through interpersonal ties (for example by friendship, shared community origin or employment).

In addition to the theory, a large number of empirical cases have been analyzed. A non-exhaustive list of examples includes: studies investigating the impact of foreigners on the labor market of the host country (e.g., Borjas 1994, 2003, 2005; Borjas, Freeman and Katz 1996; Card 2005; Fullin and Reyneri 2010), underemployment (Slack and Jensen 2007), possible connections between immigration and nations' poverty rates (Raphael and Smolensky 2009), transfer of identity from the first to second generation immigrants (Casey and Dustmann 2010), difference in education, earnings and employment between first and second generation immigrants (Algan et al. 2010), problems of integration of different cultures and languages (e.g., Lazer 1999; Contucci and Ghirlanda 2007), and the tendency for immigrants to live in ethnic ``enclaves'' (Edin, Fredriksson and Aslund 2003). 

Despite the increasing amount of  literature on international migration, to the best of our knowledge no studies have attempted to model the spatiotemporal polarization of the incidence of resident foreigners in the total population of a country. The results of such an investigation would complement previous findings, and would better help guide governmental policy. This is particularly relevant given the work of Massey et al. (1993), since migration patterns will tend to be similar year-on-year due to the network effect, the facility for policy-makers to map where migrants are particularly prevalent.

The incidence of resident foreigners can be calculated as follows
\beq
\% \ incidence \ of \ resident \ foreigners_j  = \frac{number \ of \ resident \ foreigners_j}{total \ resident \ population_j} \times 100
\label{first.d1}
\eeq
where $j$ denotes a specific area such municipality, province, or region (e.g., De Bartolo 2007; Lowell 2007; Coleman 2008; Miguet 2008).

In the special issue of \textit{The Economic Journal} dedicated to `the integration of immigrants and its consequences', Manning (2010) observes that many European countries are currently experiencing a significant increase in immigrants in their populations. Here we consider the Italian case. 

According to the official statistics of the Italian National Statistical Office (ISTAT), over the period $2003-2008$, the incidence of resident foreigners in the total population has increased from $3.4\%$ to $6.5\%$. This large increase has been partly attributed to the regularization of previously illegal immigrants as part of new legislation (law no. 189/2002; see Zincone (2002) for more details). Even taking this into account, the change is remarkable if we consider that, according to the census (carried out every ten years), during the period $1991-2001$ the incidence increased from $0.6\%$ to $2.3\%$. 

Recent trends in migration have caused important socio-demographic and economic changes. For example, recent official statistics have highlighted an increase in marriage between Italians and foreigners, as well as an increased number of entrepreneurs with foreign citizenship. The projections up to 2050 produced by ISTAT suggest a continuing, substantial increase in numbers of resident foreigners (about $17\%$ of the total population by 2050 as shown in Figure \ref{fig1}). Such a tendency is not uncommon in European countries (e.g., Alders, Keilman and Cruijsen 2007). It is therefore of paramount importance to formulate adequate social policies which can support, for example, the process of integrating immigrants into their host country. It is crucial to promote recognition and respect for different cultural identities with the aim of ensuring community cohesion between foreign and native people, and thus avoid social unrest (e.g., Cheong et al. 2007; Van Der Veer 2003). Immigrants' rights and integration policies typically relate to specific laws regarding public health and education (e.g., Zincone 2006). Taking a wider view, though, policies may also relate to professional training and the right to housing, as well as guidance and counselling on legal issues and administrative procedures. Key to policy makers decisions must be the knowledge of which areas of the country such policies should be enacted and strengthened due to a higher incidence of foreigners; the spatiotemporal maps produced using the proposed approach provide important insights into this matter for practitioners.

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.41\textwidth, angle=270]{Figure1.eps}
	\caption{The graphs show the trend of resident foreigners in Italy during $2003-2008$ and in forecast for the period $2009-2050$, based on the official statistics and projections of ISTAT. The information is reported in terms of number (divided by 1000) and incidence of resident foreigners. Both variables are calculated at the end of December of each year, except for 2001 which is obtained from the population census (October $21^{th}$). The average, low and high scenarios are by the solid and dotted lines, respectively.}
	\label{fig1}
\end{figure}

Measure (\ref{first.d1}) represents a simple well known demographic indicator for comparing different regions of a country in terms of number of foreigners per 100 resident inhabitants. It can be thought of as indicative of the spatial distribution of foreigners and thus identify areas of the country with a greater or lesser presence of resident foreigners in the population (e.g., OECD 2004). If such distribution is unbalanced in space and time, then there are most likely factors that attract more foreigners to that area as opposed to another. In fact, inhomogeneous spatial incidence may be explained by several characteristics of an area. Example of such characteristics include the presence of foreigners with the same origin (recall, e.g., the network theory, above), and an area's relative abundance of affordable (or socialised) housing.

To asses what draws foreigners to a particular area over anther, it is desirable to have some quantitative measure of the attractiveness of each area. We focus on factors of economic and labour market nature, construct a composite indicator that we have named `Index of Spatial Economic Attractiveness' and produce spatiotemporal maps of the index. Three important variables constitute the index: (i) added value per capita, (ii) unemployment rate and (iii) employment rate. Since these are typically readily available, this composite indicator can be easily constructed for many countries. The results can be analyzed in the light of the spatiotemporal maps of the incidence of resident foreigners.

The novel empirical analysis proposed in this article addresses the points discussed above. Our study is carried out for Italy by using data from ISTAT which, since 2002, has provided a public database with annual frequency of the number of resident foreigners at a municipal level. This information is new in the field of Italian statistics, and currently represents the maximum spatial and temporal detail available. Spatiotemporal modelling can be achieved via the use of splines which can perform smoothing over some bounded domain $\Omega\subseteq\mathbb{R}^2$, over time (e.g., Hastie and Tibshirani 1990; Ruppert, Wand, and Carroll 2003; Wood 2006). Here, the response (incidence of resident foreigners) is modelled as a function of time and spatial coordinates. The model can then be used to create smooth maps of the geographical area of interest over time. Two points are noteworthy here. First, when a geographical region has complex boundaries, as in many applied contexts, features from one part of the domain can unduly influence other parts giving rise to a phenomenon known as \textit{leakage} (e.g., Ramsay 2002). Leakage typically occurs when a smoother inappropriately links two parts of a domain causing the fitted surface to be mis-estimated, hence leading to incorrect inference (e.g., biased incidence estimates), which is clearly not desirable. This issue can be overcome if the smoother used can account for the structure of the domain that is under investigation; several solutions have been proposed (Ramsay 2002; Wood, Bravington and Hedley 2008, and references therein). Second, given that it is unlikely that the spatial trend of incidence of resident foreigners is additive in time, the employed approach should account for a space-time interaction. These two goals can be jointly achieved by using a scale-invariant three-dimensional tensor product smoother combining a cubic regression spline basis function for time trend and a soap film spline basis for the spatial dimensions (Wood 2006; Wood, Bravington and Hedley 2008).

The remainder of the article is organized as follows.


\section{Data \label{DAT}}

\subsection{The main features \label{SDC}}

The entry of foreigners from some countries of the European Union (EU) into Italy is regulated by the Schengen agreements. These allowed for the elimination of border controls, hence creating a common area of free movement among the state members (e.g., Broeders 2007). Foreigners from a non-EU country must possess a visa authorization or the necessary documents (for further details see the official website of the Ministry of the Interior http://www.interno.it). The main reasons for entering Italy as a foreigner are typically the following: study, tourism, work and family reunification. 

As pointed out by Coleman (2008), in many countries the official statistics typically report the number of resident foreign citizens, but not the number of immigrants born in foreign countries. These are not the same. Currently, the dynamics of immigration to Italy still allows the acceptance of a definition which does not distinguish between immigrants and foreign resident population identified by citizenship. This simplification is reasonable in the first phase of the immigration process in a country, and when the majority of immigrants keep their own citizenship for a long period. This is the case for Italy. Only the population census allows the best distinction between immigrants and foreigners. In this case the data can be analyzed by birthplace, citizenship at birth, and citizenship at the census time. 

Here we consider the statistics on resident foreign population. It is made up of people of non-Italian citizenship with usual residence in the country, and registered in the official population registries of the municipality in which they live. Their nationality corresponds to the country of origin, unless otherwise stated on the identity document. The Italian official statistics on resident foreign population are mainly based on administrative sources which are linked to specific laws. Since 2002, ISTAT has integrated the official statistics with a new annual public database (http://demo.istat.it). It makes available the total number of resident foreigners calculated at the end of December of each year, for each of the about 8100 municipalities. This actually represents the maximum spatial detail available. For each municipality, we have worked out measure (\ref{first.d1}) for the period $2003-2008$. As compared to the use of provincial or regional data, the municipal detail offers a better information on the spatial distribution of the foreigners in the total population.

%We think that six years can be considered a period sufficient for capturing relevant changes in spatiotemporal trends of the phenomenon under study. For istance, as shown above, the observed increase of the incidence (\ref{first.d1}) in the period 2003-2005, it was of about $100\%$. For this reason, we expect a spatiotemporal changes that can be considered significative. On the contrary, if we had observed a non-significant growth of the measure (\ref{first.d1}), we would have considered all the available period. 

As well known in demographic science, populations are dynamic over time.  The increase or decrease of foreign people, at the end of the year, is determined by the following demographic flows 
$$
RFP^{31^{th}}_{jy} = RFP^{1^{st}}_{jy} + (I_1 + I_2 + I_3+ I_4) - (D_1 + D_2 + D_3 + D_4 + AC), 
$$ 
where $RFP^{31^{th}}_{jy}$ indicates the total number of resident foreigners calculated at the end of December in the $j^{th}$ Italian municipality for the $y^{th}$ year, and $RFP^{1^{st}}_{jy}$ the number of resident foreigners at the $1^{st}$ of January. $I_{1}$ denotes people whose parents are foreigners (at least one of them being resident in the municipality), $I_{2}$ the foreign citizens who asked to transfer their residence from an Italian municipality to the current one, $I_{3}$ those who asked to transfer their residence from abroad, and $I_{4}$ refers to recording operations due to several reasons. $D_{1}$ represents the resident foreigners who died during the year, $D_{2}$ those removed from the registry of the current municipality because transferred to another one, $D_{3}$ foreigners removed from the registry because transferred their residence abroad, $D_{4}$ refers to cancellations, and \textit{AC} denotes the resident foreigners who obtained the Italian citizenship during the year. 

Acquisition of the Italian citizenship by foreigners is regulated by law 91 of the $5^{th}$ of February 1992 and subsequent amendments and additions. Foreigners can acquire the Italian citizenship mainly for marriage with an Italian or for `naturalization'. The last case refers to a situation in which the foreigner has lived in the country from a certain period of time. Such a period may vary based on the following criteria: (a) at least 10 years for non-EU citizens, (b) at least 4 years for EU citizens, (c) at least 5 years for political refugees or stateless persons, and (d) at least 5 years for adult individuals who been adopted by Italian citizens. These do not provide a list of all possible cases. Moreover there exist further cases to obtain the citizenship. See http://www.interno.it for more details. 

Once the foreigners have acquired the Italian citizenship, they are included in the Italian population's statistics. Currently, no information on the number of resident Italian citizens by origin is available. It could be interesting to know the number of people that are Italian by birth, and those who obtained the citizenship. For instance, this information could be useful for monitoring the ethnic and cultural diversity in the population. However, the multi-ethnic or multi-cultural aspect is not of interest given our purposes. %, but could be useful for a possible extension of this work. 

The phenomenon of illegal foreigners (e.g., Carter 1999; Hillman and Weiss 1999; De Bartolo 2007; Bchir 2008; Cangiano 2008) and its respective quantification (e.g., Strozza 2004) is also important to policy-makers and scholars. It refers to foreigner people who are not in possession of a visa authorization, the necessary documents or a valid permission to be in the country. In the literature, several solutions have been proposed in order to quantify this phenomenon, but all of them are subject to criticism especially related to the magnitude of the error in the estimates. For this reason, we only make use of the official data on the resident foreign population, hence avoiding the introduction of possible distorting factors which are not directly controllable and quantifiable. %The assumptions made in our study is that the incidence of foreigners (\ref{first.d1}) can be very close to the real data observed in hypotesis of absence of illegal foreigners in the country.


\subsection{Demographic contribution of foreign population \label{DEM}}

Assuming the absence of migration flows from abroad in the prediction of the population until 2052, for each of the 27 European countries, Bijak et al. (2007) showed that many nations could register a decline in the resident population. Typically, the main causes are the progressive aging of the population structure and the low fertility rate. For Italy, it has been estimated a possible decrease in the population from 57 million in 2002 to about 43 million in 2052. The ratio between old population (people who are more than 64 years old) and young population ($0-14$ years) was equal to 143.4 at the end of 2008 (index equal to 156.2 if considering only the population made up of individuals with Italian citizenship). This means that the elderly population is about $43\%$ larger than the young population. The contribution of the resident foreign population to the index amounts to 11.2 (notice that the average age of resident foreigners is of about 30 years). Looking at the most recent fertility rate released by ISTAT, the average number of children for Italian women in childbearing age (from 15 to 49 years) is equal to 1.33; a low number if compared with the average of 2.05 children for the foreign women. The total fertility rate, combining both italian and foreign women, is equal to 1.41. Coleman (2008) recalls that ``typically, in low-mortality populations a total fertility of about 2.04 is regarded as the `replacement level', that is, a level sufficient to replace the population in the long-run, ignoring migration''. However, following other scholars, Coleman also pointed out that, given the impact of foreigners in the population structure of many countries, the measure of total fertility, and hence the level of replacement, must also take into account the contribution of immigrants. In recent years, the presence of foreigners in Italy has contributed not only to population growth, but also to the reduction in the aging index and the increase in the total fertility rate. 

The profile of the nationalities of resident foreigners in Italy is changing. In 2003, the top three countries were Albania ($13.6\%$), Morocco ($12.7\%$) and Romania ($8.9\%$). In 2008, Romania was the first country ($20.5\%$), followed by Albania ($11.3\%$) and Morocco ($10.4\%$). The significant increase of the Romanian population in Italy has occured with the country's entry to the European Union ($1^{th}$ January 2007). Currently, it is the predominant nationality in 14 Italian regions out of 20. Ban (2009) pointed out that Italy hosts the largest Romanian community outside Romania and almost half of the entire Romanian migrant stock. The choice of Italy as primary destination for Romanians can be explained by many factors including the presence of small Italian companies, the economic links with in Romania, and the accessible language for this population. In 2008 the resident foreign population in Italy was made up of $53.6\%$ individuals from the European area, $22.4\%$ from Africa, $15.8\%$ from Asia, $8.1\%$ from America, and $0.1\%$ from Oceania.


\section{Methodology \label{METH}}

\subsection{Model specification \label{MS}}

The model we employ belongs to the class of generalized additive models (GAMs, Hastie and Tibshirani 1990). They allow for  complex relationships between covariates and response variable, which are crucial to uncover interesting features in the data. Notice that the incidence of resident foreigners exhibits a positively skewed distribution. For this reason, a gamma distribution provides a realistic description of the response variable. The proposed model is as follows
\beq
\text{log}\left\{\E(\texttt{irf}_{it})\right\} = f(\texttt{year}_t,\texttt{n}_i,\texttt{e}_i), \quad \texttt{irf}_{it} \sim \text{Gamma},          
\label{PropM}
\eeq
for $i=1,\ldots,8094$ and $t=1,\ldots,6$. The log link function ensures positive fitted values. $\texttt{irf}_{it}$, $\texttt{n}_i$, and $\texttt{e}_i$ represent the variables percentage incidence of resident foreigners, northing, and easting, respectively. The function $f$ is a multidimensional smooth of \texttt{year}, \texttt{n}, and \texttt{e} which models the joint effect of these variables on \texttt{irf}. Notice that we want both the space and time dimension to have an optimal degree of smoothness in terms of the bias variance trade-off. This means that the chosen smoother has to be invariant to the relative scaling of space (km) and time (years). This can be achieved by using a multidimensional tensor product smooth combining a cubic regression spline basis for \texttt{year} and an \textit{isotropic} soap film spline basis for the two spatial dimensions \texttt{n} and \texttt{e}, since the smoother should not depend on the coordinate system used and account for the structure of the geographical domain under investigation (details are given in the next two sections). The smooth component in (\ref{PropM}) is subject to identifiability constraints; see Wood (2006) for more details.

\subsection{A three-dimensional tensor product smoother for time and space \label{3D}}

The construction of a three-dimensional scale invariant tensor product smoother of time and space is based on a marginal one-dimensional spline basis for time and a two-dimensional marginal smooth for space, with associated quadratic penalties measuring their roughness. We omit the subscripts $i$ and $t$ for simplicity. Let us assume that we have two low-rank regression spline bases of any type to represent the smooth functions $f_\text{year}$ and $f_\text{space}$, we can write (e.g., Ruppert, Wand and Carroll 2003; Wood 2006)
$$
f_\text{year}(\texttt{year})=\sum_{l=1}^L \alpha_l a_l(\texttt{year})=\textbf{X}_\text{year}\bm\alpha \ \ \text{and} \ \ f_\text{space}(\texttt{n},\texttt{e})=\sum_{r=1}^R \gamma_r d_r(\texttt{n},\texttt{e})=\textbf{X}_\text{space}\bm\gamma,
$$
where the $a_l(\texttt{year})$ and $d_r(\texttt{n},\texttt{e})$ are known cubic regression spline and soap film basis functions, with corresponding parameters $\alpha_l$ and $\gamma_r$, $L$ and $R$ are the spline dimensions of the two smooth components, and $\textbf{X}_\text{year}$ and $\textbf{X}_\text{space}$ are marginal model matrices evaluating the basis functions with parameter vectors $\bm\alpha$ and $\bm\gamma$. Notice that the expansion for $f_\text{space}$ and its roughness penalty (described in the next paragraph) do not correspond exactly to the expressions used to set up the model. In this section, we are concerned with illustrating the construction of a three-dimensional scale invariant tensor product smoother, hence it is convenient to keep the description of the two-dimensional marginal smooth for space and its quadratic penalty as simple as possible. A rigorous description will be given in the next section. In order to set up a three-dimensional tensor product smoother for time and space we need $f_\text{year}(\texttt{year})$ to vary smoothly within the space dimensions. This can be achieved by allowing the parameters $\alpha_l$ to vary smoothly with \texttt{n} and \texttt{e}. Using the spline set-up for $f_\text{space}(\texttt{n},\texttt{e})$ we can write (e.g., Wood 2006, p. 163)
$$
\alpha_l(\texttt{n},\texttt{e})=\sum_{r=1}^R \gamma_{lr} d_r(\texttt{n},\texttt{e})
$$    
which results in
$$
f(\texttt{year},\texttt{n},\texttt{e})=\sum_{l=1}^L \sum_{r=1}^R \gamma_{lr} d_r(\texttt{n},\texttt{e}) a_l(\texttt{year}). 
$$
For any particular set of observations of \texttt{year}, \texttt{n}, and \texttt{e}, there exists a simple relationship between the matrix $\textbf{X}$ evaluating the tensor product smooth at these observations, and the model matrices $\textbf{X}_\text{year}$ and $\textbf{X}_\text{space}$ evaluating the marginal smooths at the same observations. Ordering appropriately the parameters $\gamma_{lr}$ into a vector $\bm\theta$, the $i^{th}$ row of $\textbf{X}$ is given by $\textbf{X}_{i}=\textbf{X}_\text{year,i}\otimes\textbf{X}_\text{space,i}$, where $\otimes$ is the Kronecker product. 

Within the GAM context, it is necessary to quantify the roughness of the smooth functions in the model so that over-fitting can be accounted for and hence avoided during the parameter estimation process (e.g., Marra and Radice 2010). As for the penalty associated with this tensor product basis, it is possible to start from roughness measures associated with the marginal smooths $f_\text{year}(\texttt{year})$ and $f_\text{space}(\texttt{n},\texttt{e})$. Suppose that functionals $Js$ measuring the roughness of the smooth terms are available, and that these can be written as quadratic forms in the marginal parameters, we have that
$$
J_\text{year}(f_\text{year})=\bm\alpha\ts\textbf{S}_\text{year}\bm\alpha \ \ \text{and} \ \ J_\text{space}(f_\text{space})=\bm\gamma\ts\textbf{S}_\text{space}\bm\gamma,
$$
where the $\textbf{S}$ matrices contain known coefficients whose values depend on the chosen bases for time and space. For instance, the second-order cubic spline penalty for $f_\text{year}(\texttt{year})$ evaluates $J_\text{year}(f_\text{year})=\int\left( \partial^2 f_\text{year}/\partial \texttt{year}^2 \right)^2 d\texttt{year}$, but it may be more complex (Wood 2006, 2008). Following, e.g., Zanin and Marra (2010), an overall penalty for the tensor product smooth can be obtained by applying the penalties of $f_\text{space}(\texttt{n},\texttt{e})$ to the varying coefficients of the marginal smooth $f_\text{year}(\texttt{year})$, $\alpha_l(\texttt{n},\texttt{e})$,
$$
\sum_{l=1}^L J_\text{space}\left\{  \alpha_l(\texttt{n},\texttt{e}) \right\},
$$ 
and the penalties of $f_\text{year}(\texttt{year})$ to the varying coefficients of the marginal smooth $f_\text{space}(\texttt{n},\texttt{e})$, $\gamma_r(\texttt{year})$,  
$$
\sum_{r=1}^R J_\text{year}\left\{  \gamma_r(\texttt{year}) \right\}.
$$ 
It follows that the roughness penalty of $f(\texttt{year},\texttt{n},\texttt{e})$ can be measured as 
$$
J(f)=\lambda_\text{space} \sum_{l=1}^L J_\text{space}\left\{  \alpha_l(\texttt{n},\texttt{e}) \right\} + \lambda_\text{year} \sum_{r=1}^R J_\text{year}\left\{  \gamma_r(\texttt{year}) \right\},
$$
which can also be written as
$$
\lambda_\text{space} \bm\theta\ts \textbf{I}_L \otimes \textbf{S}_\text{space} \bm\theta + \lambda_\text{year} \bm\theta\ts \textbf{S}_\text{year} \otimes \textbf{I}_R  \bm\theta,
$$
where, once again, the vector $\bm\theta$ contains the tensor product smooth parameters. The $\lambda$ are smoothing parameters controlling the trade-off between model fit and model smoothness. The next section shows how $f_\text{space}$ and $\textbf{S}_\text{space}$ can be constructed.   


\subsubsection{Soap film \label{SF}}

As alluded to above, the smoother used for the spatial part of the model must take into account of the fact that the borders of Italy represent both physical and administrative geographic features. Clearly a rather na\"ive model would smooth over the bounding box encompassing all of the region we wish to draw inference on, this is not useful; first, because there are no foreigners in the sea (at best there are merely potential foreigners) and second, because smoothing over this whole area would cause leakage, as mentioned in the introduction.

Leakage occurs when a smoother inappropriately links two pats of a domain, this can happen when a two peninsulae jut out into the sea with different population densities on either side. Say one has a very high density, where as the other is significantly lower. Most smoothers will not respect that the two areas are different and should be treated so. Rather, the model will ``smooth across'' this gap, causing the high functional values to ``leak'' into the low valued peninsula and vice versa. There are, of course, situations in which leakage is appropriate. For example, in a study of the propagation of a chemical through a river system, there are several mechanisms to transport the chemical (e.g., surface water flow, animals) other than the river itself. Therefore there must be a motivation for why we wish to use a model that specifically prevents leakage. This is the case here, as there is no particular reason we should believe that the foreign population should be continuous across physical boundaries such as the Mediterranean Sea.

The soap film smoother (Wood, Bravington and Hedley 2008) uses a rather simple physical model to prevent leakage from occurring. First, consider the domain boundary to be made of wire, then dip this wire into a bucket of soapy water, you will then have a soap film in the same shape as the boundary (provided it doesn't pop(!)). Now consider the wire to lie in the $\texttt{n}$-$\texttt{e}$ plane and the height of the soap film at a given point to be the functional value of the model. This film is then distorted smoothly by moving it vertically toward each datum locally, while minimising the surface tension in the film as a whole. The domain ($\Omega$) is bounded by some polygon ($B$) which, in this case is the coastlines. The boundary conditions on $B$ are estimated using a cyclic spline (Wood 2006, p. 151).

In order to perform soap film smoothing, we must first construct two sets of basis functions to form a smoother that conforms to the necessary boundary conditions. The first basis is used for the smoothing within the region of interest ($\Omega$); the second is for finding the values on the boundary (i.e., smoothing on $B$ itself). These bases are then summed to form
\beq
f_\text{space}(\texttt{n},\texttt{e})=\sum_{j=1}^J \alpha_j a_j(\texttt{n},\texttt{e}),+\sum_{k=1}^n \gamma_k g_k(\texttt{n},\texttt{e}),
\eeq
where the $\gamma_k$ and $\alpha_j$ are the parameters to be estimated. One can think of the $a_j(\texttt{n},\texttt{e})$ as an offset dictated by the estimated boundary conditions on $B$ and the sum of the $g_k(\texttt{n},\texttt{e})$ as the smooth to the data inside $\Omega$. We now show how these bases are constructed.

For the internal part of the smooth we first find a set of functions $\rho_k(\texttt{n},\texttt{e})$, which are each solutions to the Laplace equation in two dimensions
\beq
\frac{\partial^2\rho}{\partial \texttt{n}^2} + \frac{\partial^2\rho}{\partial \texttt{e}^2} = 0
\eeq
except at one of the knots ($\texttt{n}^*_k,\texttt{e}^*_k$). Then, we solve Poisson's equation in 2-dimensions
\beq
\frac{\partial^2 g_k}{\partial \texttt{n}^2} + \frac{\partial^2 g_k}{\partial \texttt{e}^2} = \rho_k(\texttt{n},\texttt{e})
\label{soap-poisson}
\eeq
for $k$ indexing the $n$ knots. When the boundary condition $\rho_k(\texttt{n},\texttt{e})=0$ is applied, the set of basis functions for the soap film smoother, $g_k(\texttt{n},\texttt{e})$ is found.  The PDEs are solved numerically using successive overrelaxation (Wood, Bravington and Hedley 2008, for further details).

To find the boundary basis we first take a a `boundary function', $f_\text{bnd}(r)$, using cyclic splines. The function evaluates the height of the function at each point around the boundary. $f_\text{bnd}(r)$ will have the expansion
\beq
f_\text{bnd}(r)=\sum_{j=1}^J \alpha_j \delta_j(r),
\label{soap-cyclic}
\eeq
where $r$ is the distance along the boundary, the $\alpha_j$ are parameters and $\delta_j$ are known cubic spline basis functions. To ensure that the spline is cyclic the usual constraint is enforced: that the value of the function at the first knot is the same as that at the last knot up to their second derivatives. Note that we don't find the $\alpha_j$ at this stage, for now we are only interested in the expansion. The basis functions $a_j(\texttt{n},\texttt{e})$ themselves can be found by solving (\ref{soap-poisson}) for $\rho_k(\texttt{n},\texttt{e})\equiv 0$ with the boundary condition resulting from setting $\alpha_j=1$ (and all other $\alpha_i$ to zero) in (\ref{soap-cyclic}), using the same methods as for the $g_k(\texttt{n},\texttt{e})$, above. The $a_j(\texttt{n},\texttt{e})$ can be thought of as the set of functions with a peak at each of the $J$ points around the boundary in turn which are smooth across the whole of $\Omega$.

We have now found the set of basis functions for the inside of the domain and also the boundary-induced-smooth which acts as a base for the soap film smoother. Although this seems like a rather esoteric setup, all the procedure above is effectively doing is setting up a basis in order that we can use standard penalized regression techniques. Just as some spline bases are isotropic or non-isotropic, the soap film basis has the property that it obeys the boundary of the region we are smoothing over.

As with the basis, the penalty is split into two parts: one for the cyclic smooth around the boundary and one for the internal smooth. Writing $\bm\beta$ as the vector of all smooth coefficients for the soap film, $\bm\gamma$ for the boundary smooth parameters and $\bm\alpha$ for the interior, we have
$$
\bm\beta^\text{T}\textbf{S}_\text{space}\bm{\beta} = \lambda_\text{bnd} \bm\gamma^\text{T}\textbf{S}_\text{bnd}\bm{\gamma} + \lambda_\text{int} \bm{\alpha}^\text{T}\textbf{S}_\text{int}\bm{\alpha},
$$
where 
$$
\textbf{S}_\text{space} = \lambda_\text{bnd} \textbf{S}_\text{bnd} + \lambda_\text{int} \textbf{S}_\text{int}.
$$
$\textbf{S}_\text{space}$ is the total penalty for the spatial part of the smooth, $\textbf{S}_\text{int}$ is the interior penalty and $\textbf{S}_\text{bnd}$ is the cyclic spline boundary penalty. The $\lambda$ are the smoothing parameters for the boundary and interior smooths respectively. We now look at the two parts of the penalty individually. Letting,
$$
f_\text{int}=\sum_{k=1}^n \gamma_k g_k(\texttt{n},\texttt{e}),
$$
the isotropic interior penalty term is calculated as
$$
\textbf{S}_\text{int} = \int_\Omega \Big(\frac{\partial^2 f_\text{int}}{\partial \texttt{n}^2}+\frac{\partial^2 f_\text{int}}{\partial \texttt{e}^2} 
\Big)^2\text{d}\texttt{n}\text{d}\texttt{e},
$$
Differing from the standard thin plate regression spline penalty (\textbf{??? we suddenly introduce TPRS, we need to explain at least that TPRS is another approach and that we do better by using soap}) since: (\emph{i}) the integration occurs only over $\Omega$, (\emph{ii}) there is no mixed derivative term, and (\emph{iii}) the whole integrand is squared rather than each term individually. This allows the $\texttt{n}$ and $\texttt{e}$ term's derivatives to be traded off against each other so the nullspace of the penalty is infinite dimensional. This allows those functions in the nullspace to be sufficiently wiggly to meet any boundary conditions. The penalty for the cyclic spline running about the boundary, used to calculate the $\alpha_j$ is calculated as
\beq
\textbf{S}_\text{bnd} = \int_B \Big(\frac{\partial^2 f_\text{bnd}}{\partial r^2}\Big)^2 \text{d}r, 
\eeq
as normal.

The solution of the PDEs above, yielding the basis and penalty, is the most computationally expensive part of the procedure. Knots to use for $\texttt{n}_k^*$ and $\texttt{e}_k^*$ must be specified, here we use a grid (further detail on our exact setup is given below). In summary, we now have both the basis functions $\textbf{A}_{ij}=a_j(\texttt{n}_i,\texttt{e}_i)$ and $\mathbf{G}_{ij}=g_j(\texttt{n}_i,\texttt{e}_i)$, which make up the $i^{th}$ row of the model matrix $\textbf{X}_\text{space}$, and the penalties $\textbf{S}_\text{bnd}$ and $\textbf{S}_\text{int}$, forming $\textbf{S}_\text{space}$, for the soap film smoother.
%\beq
%\| \bm{z}-\textbf{A}\bm{\alpha}-\textbf{X}\bm{\gamma}\|^2 + \lambda_\text{bnd}\bm{\alpha}^\text{T}\textbf{S}_\text{bnd}\bm{\alpha}+ %\lambda_\text{int}\bm{\gamma}^\text{T}\textbf{S}_\text{int}\bm{\gamma}
%\eeq
%where $\textbf{A}_{ij}=a_j(\texttt{n}_i,\texttt{e}_i)$, $\mathbf{X}_{ij}=g_j(\texttt{n}_,\texttt{e}_i)$ and $\bm{z}$ are the observed values.



\subsection{Parameter estimation \label{PE}}

In model (\ref{PropM}), replacing $f$ with its tensor product expression yields a generalized linear model (McCullagh and Nelder, 1989) whose design matrix contains the spline bases representing the smooth component in the model. This means that in principle such
a model can simply be estimated by maximum likelihood (ML). However, in a smoothing spline context, unpenalized parameter estimation is likely to result in smooth component estimates that are too `wiggly', hence undermining the utility of such a model. This can be overcome by penalized ML, where the use of penalties allows for the suppression of that part of smooth term complexity which has no support from the data (e.g., Marra and Radice 2010). Specifically, the model can be fitted by minimization of
\beq
D(\bm\theta) + \bm\theta\ts\textbf{S}\bm\theta \ \  \text{w.r.t.} \ \  \bm\theta,
\label{Dev}
\eeq
where $\bm\theta$ contains all tensor product smooth parameters associated with the one-dimensional spline basis for time and two-dimensional smooth for space, and $\textbf{S}=\sum_i \lambda_i \textbf{S}_i$, where the $\textbf{S}_i$ are matrices of known coefficients properly defined according to the results of the previous sections with associated smoothing parameters $\lambda_i$. The model deviance, $D$, is defined as $2\phi(l_{\text{sat}}-l)$, where $\phi$ is a dispersion parameter, $l$ is the log-likelihood of the model and $l_{\text{sat}}$ the maximum value for the log-likelihood of the model with one parameter per datum. 

Given values for the $\lambda_i$, minimization of (\ref{Dev}) is straightforward. However, smoothing parameter estimation has to be addressed. This can be achieved by minimization of a prediction error estimate, such as the generalized cross-validation (GCV) (Craven and Wahba 1979), or by approximate restricted ML (REML) estimation (Wood 2010). Smoothing parameter selection via the GCV consists of minimizing 
\beq
V(\bm\lambda)=\frac{nD(\hat{\bm\theta})}{\left\{n-\text{tr}(\textbf{A})\right\}^2},
\label{GCV1}
\eeq
where $\textbf{A}$ is the usual hat matrix, and $\text{tr}(\textbf{A})$ represents the effective degrees of freedom (edf) or number of estimated parameters of the penalized model. Wood (2006) described a computational procedure to estimate smoothing parameters on the basis of criterion (\ref{GCV1}). As an alternative, approximate REML can be employed. Within this framework, the penalized likelihood estimates, $\hat{\bm\theta}$, can be seen as the posterior modes of the distribution of $\bm\theta|{\bf y}$ if $\bm\theta \sim N(\textbf{0},\textbf{S}^{-1})$, where $\textbf{S}^{-1}$ is an appropriate generalized inverse. Viewing the spline parameters as random effects allows for the possibility to estimate the $\lambda_i$ via REML (Wahba 1985). The recent work by Reiss and Ogden (2009) shows that at finite sample sizes GCV is prone to undersmoothing and is more likely to develop multiple minima than REML. Therefore, we employ REML given its practical advantages for smoothing parameter selection. We use the \texttt{gam()} function of the \texttt{R} package \texttt{mgcv} since approximate REML optimization for GAMs is reliably and efficiently implemented (Wood 2010). During the model fitting process, all gamma distributions for all years are assumed to have a common shape parameter since preliminary descriptive analysis suggested that this is the case.

Given the dimension of the dataset used here, we experienced some memory issues which could not be sorted out. This was eventually dealt with by trying to find a compromise between tensor product basis dimension and dataset reduction. The final model was fitted on data obtained by averaging over a $150\times150$ grid for all years. The basis sizes (for the cubic regression splines and cyclic splines) and interior knots (for the soap film) are given in Table \ref{soap-basis-table}.

\begin{table}[htbp]
\centering
\begin{tabular}{c c c c}\\
\hline
\hline
Region & Interior knots & Cyclic spline basis size & Cubic spline basis size\\
\hline
Main land & 109 (20x25) & 50 & 20\\
Sardinia & 50 (10x10) & 20 & 4\\
Sicily & 40 (10x10) & 20 & 4\\
\hline
\hline
\end{tabular}
\caption{Basis sizes per region for the smooth functions to be fit to the Italian data. For the interior (soap film) knots, the numbers in brackets show the initial grid, the other number gives the number of knots actually used (i.e., with those outside the boundary or causing numerical problems with the fitting procedure removed).}
\label{soap-basis-table}
\end{table}

The spatiotemporal structure of model (\ref{PropM}) and the lack of availability of economic variables at municipal level would suggest to fit the model by also taking into account the possible presence of some unexplained spatial and autocorrelation structure in the data. In a smoothing spline context, this can be consistently achieved by using a mixed modelling approach (Breslow and Clayton 1993). This possibility was explored by using the \texttt{gamm()} function of the \texttt{mgcv} package, which iteratively calls the \texttt{lme()} function of the \texttt{nlme} package (Pinheiro et al. 2009) for maximization; no models could be fitted due to convergence failures (see, e.g., Ruppert, Wand, and Carroll (2003) and Wood (2006) for problems and limitations with this approach). To explore the sensitivity of our estimates, we tried out a fixed effect approach (Wooldridge 2002) but the results did not change significantly.

\subsection{Variance estimation \label{VE}}

Confidence intervals can be effectively constructed using the well known Bayesian credible intervals originally proposed by Wahba (1983) or Silverman (1985) in the univariate spline model context, and then generalized to the component-wise case when dealing with Gaussian and non-Gaussian data (e.g., Gu 2002; Gu and Wahba 1993; Ruppert, Wand, and Carroll 2003). The Bayesian model representation provides a self-consistent framework for constructing intervals since the posterior distribution of the model parameters is known. Also, because these intervals include both a bias and variance component (Nychka 1988), they have good observed \textit{frequentist} coverage probabilities across the function as shown, for example, in the simulation experiments of Wang and Wahba (1995). The posterior distribution is given as
\beq
\bm\theta|{\bf y} \dot{\backsim} N( \hat{\bm\theta}, {\bf V}_{\bm\theta} ),
\label{Poster}
\eeq
where $\hat{\bm\theta}$ is the maximum penalized likelihood estimate of $\bm\theta$ obtained as explained in the previous section, which is of the form $(\X\ts{\bf W}\X+{\bf S})^{-1}\X\ts{\bf W}{\bf z}$, ${\bf V}_{\bm\theta} = (\X\ts{\bf W}\X+{\bf S})^{-1}\phi$, $\X$ contains the columns associated with the regression spline bases used to set up the model, and ${\bf W}$ and $\mathbf{z}$ are the diagonal weight matrix and the pseudodata vector at convergence of the algorithm used to fit the penalized model (e.g., Wood 2006, 2010).

Given the result above, it is easy to find confidence intervals for linear functions of the parameters such as smooth components. Intervals for non-linear functions of the model coefficients can be efficiently obtained by simulation from the posterior distribution of $\bm\theta$. Result (\ref{Poster}) can also be used to produce trend estimates as discussed in the next section.

\subsection{Trend estimation \label{TE}}
To aid interpretation of the results and also possibly uncover interesting features in the data, trend estimates for some given areas of interest can be produced using the predictive distribution of $\texttt{irf}_{it}$, constructed employing the result of the previous section. This approach has been previously adopted in the literature (e.g., Augustin et al. 2009), and can be implemented as follows:

\begin{enumerate}
	\item Repeat the following steps for $b=1,\cdots,N_b$, where $N_b$ represents the number of random draws. 
	   \begin{enumerate}
	      \item Simulate a random $N(\hat{\bm\theta}, \hat{{\bf V}}_{\bm\theta} )$ and call the resulting coefficient vector $\bm\theta_b$.
	      \item Calculate $\widehat{\E(\texttt{irf}_{it})}=\widehat{\texttt{irf}}_{itb}=\exp(\X^*_{it}\bm\theta_b)$, where $\X^*_{it}$ is evaluated at the observed values. 
	      \item For a given area of interest $a$ and year $t$, work out the quantity
	      $$\widehat{\overline{\texttt{irf}}}_{tb}^a=\frac{1}{n_a}\sum_{i=1}^{n_a} \widehat{\texttt{irf}}_{itb}.$$    
	   \end{enumerate}
	\item Produce the required summary statistics, in this case median, lower and upper $95\%$ quantiles, for the temporal trend $\widehat{\overline{\texttt{irf}}}_{tb}^a$.
\end{enumerate}
Small values for $N_b$ are typically tolerable. In practice, $N_b$ can be set to $100$. Increasing this value does not change the results which are presented in Section \ref{ER}.
 

\section{Empirical results \label{ER}}
XX

\subsection{Spatiotemporal trends \label{STT}}
XX


\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.66\textwidth, angle=270]{SmoothPlot.eps}
	\caption{to fill in}
	\label{fig2}
\end{figure}

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.66\textwidth, angle=270]{index.eps}
	\caption{to fill in}
	\label{fig3}
\end{figure}


\subsection{Foreigner presence and spatial attractiveness: is there a nexus? \label{NEX}}
XX

\subsection{Policy-maker's corner: a point of discussion \label{PM}}
XX

\section{Conclusions \label{CONC}}
XX




\begin{thebibliography}{99}

\bibitem{} Alders, M., Keilman, N., and Cruijsen, H. (2007) , ``Assumptions for long-term stochastic population forecasts in 18 European countries,'' \textit{European Journal of Population}, 23, 33--69.

\bibitem{} Algan, Y., Dustmann, C., Glitz, A., and Manning, A. (2010), ``The economic situation of first- and second-generation immigrants in France, Germany, and the UK,'' \textit{The Economic Journal}, 120, F4--F30.

\bibitem{} Augustin, N. H., Musio, M., Wilpert, K., Kublin, E., Wood, S. N., and Schumacher, M. (2009), ``Modeling spatiotemporal forest health monitoring data,'' \textit{Journal of the American Statistical Association}, 104, 899--911.

\bibitem{} Ban, C. (2009), ``Economic transnationalism and its ambiguities: the case of Romanian Migration to Italy,'' \textit{International Migration}, DOI: 10.1111/j.1468-2435.2009.00556.x.

%\bibitem{} Bauer, T., and Zimmermann, K. F. (1999), ``Assessment of possible migration pressure and its labour market impact following EU enlargement to central and eastern europe,'' IZA Research Report Series 3, Bonn.

\bibitem{} Bchir, H. M. (2008), ``The effect of mode 4 liberalization on illegal immigration,'' \textit{Economic modelling}, 25, 1051--1063.

\bibitem{} Bijak, J., Kupiszewska, D., Kupiszewski, M., Saczuk, K., and Kicinger, A. (2007), ``Population and labour force projections for 27 European countries, 2002--2052: impact of international migration on population ageing,'' \textit{European Journal of Population}, 23, 1--31.

\bibitem{} Borjas, J. G. (1989), ``Economic theory and international migration,'' \textit{International Migration Review}, 23, 457--85.

\bibitem{} Borjas, J. G. (1994), ``The economics of immigration,'' \textit{Journal of Economic Literature}, 32, 1667--1717.

\bibitem{} Borjas, J. G., Freeman, R. B., and Katz, L. F. (1996), ``Searching for the effect of immigration on the labor market,'' \textit{American Economic Review}, 86, 246--51.

\bibitem{} Borjas, J. G. (2003), ``The labor demand curve IS downward sloping: reexamining the impact of immigration on the labor market,'' \textit{The Quaterly Journal of Economics}, 118, 1335--74.

\bibitem{} Borjas, J. G. (2005), ``The labor market impact of high-skill immigration,'' \textit{American Economic Review}, 92, 56--60.

\bibitem{} Breslow, N. E., and Clayton, D. G. (1993), ``Approximate inference in generalized linear mixed models,'' \textit{Journal of the American Statistical Association}, 88, 9--25.

\bibitem{} Broeders, D. (2007), ``The new digital borders of Europe: EU database and the surveillance of irregular migrants,'' \textit{International Sociology}, 22, 71--92.

\bibitem{} Cangiano, A. (2008), ``Foreign migrants in Southern European countries: evaluation of recent data,'' in \textit{International Migration in Europe. Data, Models, and Estimates}, Editors: Raymer, J. and Willekens, F., 89--112, Wiley.

\bibitem{} Casey, T., and Dustmann, C. (2010), ``Immigrants' identity, economic outcomes and the trasmission of identity across generations,'' \textit{The Economic Journal}, 120, F31--F51.

\bibitem{} Card, D. (2005), ``Is the new immigration really so bad?,'' \textit{The Economic Journal}, 115, 300--323.

\bibitem{} Carter, T. J. (1999), ``Illegal immigration in a efficiency wage model,'' \textit{Journal of International Economics}, 49, 385--401.

\bibitem{} Cheong, P. H., Edwards, R., Goulbourne, H., and Solomos, J. (2007), ``Immigration, social cohesion and social capital: A critical review,'' \textit{Critical Social Policy}, 27, 24--49.

\bibitem{} Coleman, D. (2008), ``The demographic effects of international migration Europe,'' \textit{Oxford Review of Economic Policy}, 24, 452--76.

\bibitem{} Contucci, P., and Ghirlanda, S. (2007), ``Modelling society with statistical mechanics: an application to cultural contact and immigration,'' \textit{Quality and Quantity}, 41, 569--78.

\bibitem{} Craven, P., and Wahba, G. (1979), ``Smoothing noisy data with spline functions,'' \textit{Numerische Mathematik}, 31, 377--403.

\bibitem{} De Bartolo, G. (2007), ``Immigration in Italy: the great emergency,'' Population Association of America - Annual Meeting, March 29-31, New York, Office of Population Research, Princeton University.

\bibitem{} Edin, Per-A., Fredriksson, P., and Aslund, O. (2003), ``Ethnic enclaves and the economic success of immigrants - evidence from a natural experiment,'' \textit{The Quarterly Journal of Economics}, 118, 329--57.

\bibitem{} Fullin, G., and Reyneri, E. (2010), ``Low unemployment and bad jobs for new immigrants in Italy,'' \textit{International Migration}, In press, DOI: 10.1111/j.1468-2435.2009.00594.x.

\bibitem{} Gu, C. (2002), \textit{Smoothing Spline ANOVA Models}, London: Springer-Verlag.

\bibitem{} Gu, C., and Wahba, G. (1993), ``Smoothing Spline ANOVA with Component-Wise Bayesian Confidence Intervals,'' \textit{Journal of Computational and Graphical Statistics}, 2, 97--117.

\bibitem{} Hastie, T., and Tibshirani, R. (1990), \textit{Generalized Additive Models}, London: Chapman $\&$ Hall.

\bibitem{} Hillman, A. L., and Weiss, A. (1999), ``A theory of permissible illegal immigration,'' \textit{European Journal of Political Economy}, 15, 585--604.

\bibitem{} Hooghe, M., Trappers, A., Meuleman, B., and Reeskens, T. (2008), ``Migration to European countries: a structural explanation of patterns 1980-2004,'' \textit{International Migration Review}, 42, 476--504.

\bibitem{} Lazear, E. P. (1999), ``Culture and language,'' \textit{Journal of Political Economy}, 107, S95--S126.

\bibitem{} Lowell, L. B. (2007), ``Trends in international migration flows and stocks, 1975-2005,'' OECD Social, Employment and Migration Working Paper 58, OECD, Paris.

\bibitem{} Manning, A. (2010), ``Feature: the integration of immigrants and their children in Europe: introduction,'' \textit{The Economic Journal}, 120, F1--F3. 

\bibitem{} Marra, G, and Radice, R. (2010), ``Penalised regression splines: theory and application to medical research,'' \textit{Statistical Methods in Medical Research}, 19, 107--125.

\bibitem{} Massey, D. S., Arago, J., Hugo, G., Kouaouci, A., Pellegrino, A., and Taylor, J. E. (1993), ``Theory of international migration: a review and appraisal,'' \textit{Population and Development Review}, 19, 431--66.

\bibitem{} McCullagh, P., and Nelder, J. A. (1989), \textit{Generalized Linear Models}, London: Chapman $\&$ Hall.

\bibitem{} Miguet, F. (2008), ``Voting about immigration policy: What does the Swiss experience tell us?,'' \textit{European Journal of Political Economy}, 24, 628--41.

\bibitem{} Morawska, E. (1990), ``The Sociology and historiography of Immigration,'' in \textit{Immigration Reconsidered: History, Sociology, and Politics}, ed. Virginia Y. McLaughlin, New York: Oxford University Press, 187--240.

\bibitem{} Nychka, D. (1988), ``Bayesian Confidence Intervals for Smoothing Splines,'' \textit{Journal of the American Statistical Association}, 83, 1134--1143.

\bibitem{} OECD (2004), ``Trends in International Migration 2003,'' \textit{OECD Pubblishing}, Paris.

\bibitem{} Pinheiro, J., Bates, D., DebRoy, S., Sarkar, D., and the R Core Team (2009), \textit{nlme: Linear and Nonlinear Mixed Effects Models}, R package version 3.1- 96.

\bibitem{} Piore, M. J. (1979), \textit{Birds of Passage: Migrant Labor in Industrial Societies}. Cambridge: Cambridge University Press.

\bibitem{} Portes, A., and Walton, J. (1981), \textit{Labor, Class, and the International System}. New York: Academic Press.

\bibitem{} Ramsay, T. (2002), ``Spline smoothing over difficult regions,'' \textit{Journal of the Royal Statistical Society Series B}, 64, 307--19.

\bibitem{} Raphael, S., and Smolensky, E. (2009), ``Immigration and poverty in the United States,'' \textit{American Economic Review}, 99, 41--4.

\bibitem{} Reiss, P. T., and Ogden, R. T. (2009), ``Smoothing parameter selection for a class of semiparametric linear models,'' \textit{Journal of the Royal Statistical Society Series B}, 71, 505--524.

\bibitem{} Ruppert, D., Wand, M. P., and Carroll, R. J. (2003), \textit{Semiparametric Regression}, London: Cambridge University Press.

\bibitem{} Silverman, B. W. (1985), ``Some Aspects of the Spline Smoothing Approach to Non-Parametric Regression Curve Fitting,'' \textit{Journal of the Royal Statistical Society Series B}, 47, 1--52.

\bibitem{} Slack, T., and Jensen, L. (2007), ``Underemployment across immigrant generations,'' \textit{Social Science Research}, 36, 1415--30.

\bibitem{} Stark, O., and Bloom, E.D. (1985), ``The new economics of labor migration,'' \textit{American Economic Review}, 75, 173--78.

\bibitem{} Strozza, S. (2004), ``Estimates of the illegal foreigners in Italy: a review of the literature,'' \textit{International Migration Review}, 38, 309--331.

\bibitem{} Van Der Veer, K. (2003), ``The future of western societies: multicultural identity or extreme nationalism?,'' \textit{Futures}, 35, 169--187.

\bibitem{} Wahba, G. (1983), ``Bayesian `Confidence Intervals' for the Cross-Validated Smoothing Spline,'' \textit{Journal of the Royal Statistical Society Series B}, 45, 133--150.

\bibitem{} Wahba, G. (1985), ``A Comparison of GCV and GML for Choosing the Smoothing Parameter in the Generalized Spline Smoothing Problem,'' \textit{The Annals of Statistics}, 13, 1378--1402.

\bibitem{} Wallerstein, I. (1974), \textit{The Modern World System, Capitalist Agricolture and the Origins of the European World Economy in the Sixteenth Century}. New York: Academic Press.

\bibitem{} Wang, Y., and Wahba, G. (1995), ``Bootstrap Confidence Intervals for Smoothing Splines and Their Comparison to Bayesian Confidence Intervals,'' \textit{Journal of Statistical Computation and Simulation}, 51, 263--279.

\bibitem{} Wood, S. N. (2006), \textit{Generalized Additive Models: An Introduction with R}, London: Chapman $\&$ Hall.

\bibitem{} Wood, S. N., Bravington, M. V., and Hedley, S. L. (2008), ``Soap film smoothing,'' \textit{Journal of the Royal Statistical Society Series B}, 70, 931--55.

\bibitem{} Wood SN (2010), ``Fast stable REML estimation of semiparametric GLMs,'' \textit{Journal of the Royal Statistical Society Series B}, in press.

\bibitem{} Wooldridge, J. M. (2002), \textit{Econometric Analysis of Cross Section and Panel Data}, Cambridge: MIT Press.

\bibitem{} Zanin, L., and Marra, G. (2010), ``Modelling the probability that a household participates in tourism: the Italian case,'' \textit{Physica A: Statistical Mechanics and its Applications}, ?.

\bibitem{} Zincone, G. (2006), ``The making of policies: immigration and immigrants in Italy,'' \textit{Journal of Ethnic and Migration Studies}, 32, 347--75.


\end{thebibliography}

\end{document}



